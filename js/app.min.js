(()=>{"use strict";const e=document.getElementById("burger-button"),t=document.getElementById("header-menu"),n=e.className,s=t.className;e.addEventListener("click",(function(){e.classList.toggle(`${n}--active`),t.classList.toggle(`${s}--active`),document.body.classList.toggle("body--lock")}));let a=0;const i="canvas--visible",c="Make sure you have entered the information that meets the requirements",d="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-!#$&?|:";let o="";const l=127;for(let e=32;e<l;e++)o+=String.fromCharCode(e);let r=[];function u(e,t="enc"){0==e&&(f.value="",b.clearRect(0,0,I.width,I.height),x.value="",M.value="",r.length=0,I.classList.remove(i),E.classList.remove("option--visible"),_.classList.remove("inputs--visible"),O.classList.remove("result--visible"),A.classList.remove("inputs--decrypt"),D.classList.remove("inputs--decrypt"),N.classList.remove("inputs--decrypt"),H.classList.remove("inputs--decrypt"),j.classList.remove("inputs--decrypt"),q.classList.remove("inputs--encrypt"),P.classList.remove("result--decrypt"),X.classList.remove("result--encrypt")),1==e&&E.classList.add("option--visible"),2==e&&(_.classList.add("inputs--visible"),"enc"==t?q.classList.add("inputs--encrypt"):(A.classList.add("inputs--decrypt"),D.classList.add("inputs--decrypt"),N.classList.add("inputs--decrypt"),H.classList.add("inputs--decrypt"),j.classList.add("inputs--decrypt"))),3==e&&(O.classList.add("result--visible"),"enc"==t?(W.value=M.value,X.classList.add("result--encrypt")):(Y.innerText=function(){let e=y(M.value);const t=b.getImageData(0,0,I.width,I.height).data;let n=[];for(let s=se;s<t.length;s+=se){let a=255-t[s+3]-e;a>0&&a<l&&n.push(a)}return n.map((e=>String.fromCharCode(e))).join("")}(),P.classList.add("result--decrypt")))}function m(){if(!f.files[0])return;const e=new Image;e.src=URL.createObjectURL(f.files[0]),e.addEventListener("load",(()=>{if(I.width=e.width,I.height=e.height,e.width>=z&&e.height>=F){u(1),I.classList.add(i),b.drawImage(e,0,0,I.width,I.height);let t=b.getImageData(0,0,I.width,I.height).data.length;a=Math.floor(t/se),x.setAttribute("maxlength",a),p()}else u(0)}))}function p(){const e=x.value.length,t=a;T.innerHTML=`(${e} / ${t})`}function g(e){e.length==Z?M.classList.add("inputs__key-input--success"):M.classList.remove("inputs__key-input--success")}function h(e){const t="enc"==e?x.value:"",n="enc"!=e||t.length>=K,s=M.value,a=8==s.length;let i=!0;for(let e=0;e<t.length;e++)if(-1===o.indexOf(t[e])){i=!1;break}let l=!0;for(let e=0;e<s.length;e++)if(-1===d.indexOf(s[e])){l=!1;break}"enc"==e?(n&&i||(C.classList.add(te),setTimeout((()=>{C.classList.remove(te)}),ee)),a&&l||(U.classList.add(te),setTimeout((()=>{U.classList.remove(te)}),ee)),n&&i&&a&&l?function(){let e=y(M.value);r.length=0;let t=x.value;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n)+e;r.push(s)}const n=b.getImageData(0,0,I.width,I.height).data;let s=0;for(let e=se;e<n.length;e+=se)s<r.length?(n[e+3]=255-r[s],s++):n[e+3]<125?n[e+3]=0:n[e+3]=255;const a=new ImageData(new Uint8ClampedArray(n),I.width,I.height);b.putImageData(a,0,0),u(3),J.href=I.toDataURL(),J.download=f.files[0].name}():v(c,!1)):(a&&l||(U.classList.add(te),setTimeout((()=>{U.classList.remove(te)}),ee)),a&&l?u(3,"dec"):v(c,!1))}function y(e){let t=[];for(let n=0;n<e.length;n++)n%2==0?t.push(e.charCodeAt(n)):t.push("-"+e.charCodeAt(n));return t=Math.abs(t.map((e=>Math.floor(.5*Number(e)))).reduce(((e,t)=>e+t))),t>=ne?t=ne:t}function v(e,t=!1){const n=document.createElement("div");n.className="encryption__pop-up pop-up";var s=document.createElement("span");s.className=t?"pop-up__message":"pop-up__message-error",s.textContent=e,n.appendChild(s);var a=document.querySelector("div.encryption__inner");a.appendChild(n),setTimeout((function(){a.removeChild(n)}),1e4)}const L=document.getElementById("drop-area"),f=document.getElementById("input-file"),E=document.getElementById("option-main"),I=document.getElementById("canvas"),b=I.getContext("2d"),k=document.getElementById("button-option__encrypt"),B=document.getElementById("button-option__decrypt"),w=document.querySelectorAll(".encryption__reset"),_=document.getElementById("inputs-main"),A=document.getElementById("inputs__text"),C=document.getElementById("text-tooltip"),x=document.getElementById("input-text"),T=document.getElementById("entered-cherecter"),D=(document.getElementById("inputs__key"),document.getElementById("input-key-text-span")),U=document.getElementById("key-tooltip"),M=document.getElementById("input-key"),R=document.getElementById("input-key-show"),S=document.getElementById("input-key-indicator"),N=document.getElementById("key-generate"),$=document.getElementById("key-paste"),j=document.getElementById("text-encrypt"),q=document.getElementById("text-decrypt"),O=document.getElementById("result-main"),P=document.getElementById("result-enc"),W=document.getElementById("result-key"),G=document.getElementById("result-key-show"),H=document.getElementById("key-copy"),J=document.getElementById("canvas-download"),Q=document.getElementById("canvas-clipboard"),V=document.getElementById("canvas-share"),X=document.getElementById("result-dec"),Y=document.getElementById("decrypted-message"),z=512,F=512,K=5,Z=8,ee=2e3,te="inputs-tooltip--animate",ne=100,se=5e4;L.addEventListener("dragover",(e=>{e.preventDefault(),L.classList.add("drag-over")})),L.addEventListener("dragleave",(e=>{e.preventDefault(),L.classList.remove("drag-over")})),L.addEventListener("drop",(e=>{e.preventDefault(),L.classList.remove("drag-over"),f.files=e.dataTransfer.files,m()})),f.onchange=m,k.addEventListener("click",(()=>u(2,"enc"))),B.addEventListener("click",(()=>u(2,"dec"))),w.forEach((function(e){e.addEventListener("click",(()=>u(0)))})),x.addEventListener("input",p),M.addEventListener("input",(()=>g(M.value))),R.addEventListener("click",(()=>{M.type="password"===M.type?"text":"password",S.classList.toggle("inputs__key-hidden--visible")})),N.addEventListener("click",(()=>M.value=function(){let e="";for(let t=0;t<Z;t++){let t=Math.floor(70*Math.random());e+=d[t]}return g(e),e}())),$.addEventListener("click",(function(){navigator.clipboard.readText().then((e=>{M.value=e.slice(0,8),v("The key has been successfully pasted from the clipboard!",!0),g(M.value)})).catch((e=>console.error("Unable to paste from clipboard: "+e)))})),H.addEventListener("click",(function(){let e=M.value;navigator.clipboard.writeText(e).then((()=>v("The security key is copied to the clipboard",!0))).catch((e=>alert("Помилка копіювання: "+e)))})),j.addEventListener("click",(()=>h("enc"))),q.addEventListener("click",(()=>h("dec"))),G.addEventListener("click",(()=>{W.type="password"===W.type?"text":"password",G.classList.toggle("result__key-show--visible")})),Q.addEventListener("click",(function(){I.toBlob((function(e){const t=new ClipboardItem({"image/png":e});navigator.clipboard.write([t]).then((()=>v("The image is copied to the clipboard",!0))).catch((function(e){console.error("Error:",e)}))}),"image/png")})),V.addEventListener("click",(function(){if(navigator.share)navigator.share({title:"Share the picture",url:J.href}).catch((()=>v("Unfortunately, an error has occurred or this feature is not yet supported",!1)));else{const e="https://yourwebsite.com/share?url="+encodeURIComponent(imageElement.src);window.open(e,"_blank")}})),function(e){let t=new Image;t.onload=t.onerror=function(){!function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}()})();