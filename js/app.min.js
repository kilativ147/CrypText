(()=>{"use strict";const e=document.getElementById("burger-button"),t=document.getElementById("header-menu"),n=e.className,s=t.className;e.addEventListener("click",(function(){e.classList.toggle(`${n}--active`),t.classList.toggle(`${s}--active`),document.body.classList.toggle("body--lock")}));let i=0;const d="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-!@#$%&";let a=[];function c(e){0==e&&(u.value="",g.clearRect(0,0,p.width,p.height),I.value="",b.value="",a.length=0,m.classList.remove("option--visible"),L.classList.remove("inputs--visible"),M.classList.remove("result--visible"),E.classList.remove("inputs--decrypt"),B.classList.remove("inputs--decrypt"),x.classList.remove("inputs--decrypt"),D.classList.remove("inputs--decrypt"),A.classList.remove("inputs--decrypt"),C.classList.remove("inputs--encrypt"),U.classList.remove("result--decrypt"),S.classList.remove("result--encrypt")),1==e&&m.classList.add("option--visible"),2==e&&(L.classList.add("inputs--visible"),"enc"==K?C.classList.add("inputs--encrypt"):(E.classList.add("inputs--decrypt"),B.classList.add("inputs--decrypt"),x.classList.add("inputs--decrypt"),D.classList.add("inputs--decrypt"),A.classList.add("inputs--decrypt"))),3==e&&(M.classList.add("result--visible"),"enc"==K?(R.value=b.value,S.classList.add("result--encrypt")):($.innerText="Some shit",U.classList.add("result--decrypt")))}function l(){if(!u.files[0])return;const e=new Image;e.src=URL.createObjectURL(u.files[0]),e.addEventListener("load",(()=>{p.width=e.width,p.height=e.height,e.width>=j&&e.height>=q?(c(1),setTimeout((function(){g.drawImage(e,0,0,p.width,p.height);let t=g.getImageData(0,0,p.width,p.height).data.length;i=Math.floor(t/J),I.setAttribute("maxlength",i)}),1e3)):c(0)}))}function o(e){const t=I.value,n=t.length>=z,s=b.value,i=8==s.length;let l=!0;for(let e=0;e<t.length;e++)if(-1===d.indexOf(t[e])){l=!1;break}let o=!0;for(let e=0;e<s.length;e++)if(-1===d.indexOf(s[e])){o=!1;break}"enc"==e?(n&&l||(f.classList.add(G),setTimeout((()=>{f.classList.remove(G)}),F)),i&&o||(k.classList.add(G),setTimeout((()=>{k.classList.remove(G)}),F)),n&&l&&i&&o&&function(){let e=function(e){let t=[];for(let n=0;n<e.length;n++)n%2==0?t.push(e.charCodeAt(n)):t.push("-"+e.charCodeAt(n));return t=Math.abs(t.map((e=>Math.floor(.5*Number(e)))).reduce(((e,t)=>e+t))),t>=H?t=H:t}(b.value);a.length=0;let t=I.value;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n)+e;a.push(s)}const n=g.getImageData(0,0,p.width,p.height).data;let s=0;for(let e=J;e<n.length;e+=J)s<a.length?(n[e+3]=255-a[s],s++):n[e+3]<125?n[e+3]=0:n[e+3]=255;const i=new ImageData(new Uint8ClampedArray(n),p.width,p.height);g.putImageData(i,0,0),c(3),N.href=p.toDataURL(),N.download=u.files[0].name}()):(i&&o||(k.classList.add(G),setTimeout((()=>{k.classList.remove(G)}),F)),i&&o&&imgToText())}const r=document.getElementById("drop-area"),u=document.getElementById("input-file"),m=document.getElementById("option-main"),p=document.getElementById("canvas"),g=p.getContext("2d"),y=document.getElementById("button-option__encrypt"),v=document.getElementById("button-option__decrypt"),h=document.querySelectorAll(".encryption__reset"),L=document.getElementById("inputs-main"),E=document.getElementById("inputs__text"),f=document.getElementById("text-tooltip"),I=document.getElementById("input-text"),B=(document.getElementById("inputs__key"),document.getElementById("input-key-text-span")),k=document.getElementById("key-tooltip"),b=document.getElementById("input-key"),w=document.getElementById("input-key-show"),_=document.getElementById("input-key-indicator"),x=document.getElementById("key-generate"),T=document.getElementById("key-paste"),D=document.getElementById("key-copy"),A=document.getElementById("text-encrypt"),C=document.getElementById("text-decrypt"),M=document.getElementById("result-main"),U=document.getElementById("result-enc"),R=document.getElementById("result-key"),N=(document.getElementById("result-key-show"),document.getElementById("canvas-download")),O=document.getElementById("canvas-clipboard"),S=document.getElementById("result-dec"),$=document.getElementById("decrypted-message"),j=512,q=512,z=5,F=2e3,G="inputs-tooltip--animate",H=100,J=5e4;let K="";r.addEventListener("dragover",(e=>{e.preventDefault(),r.classList.add("drag-over")})),r.addEventListener("dragleave",(e=>{e.preventDefault(),r.classList.remove("drag-over")})),r.addEventListener("drop",(e=>{e.preventDefault(),r.classList.remove("drag-over"),u.files=e.dataTransfer.files,l()})),u.onchange=l,y.addEventListener("click",(()=>{K="enc",c(2)})),v.addEventListener("click",(()=>{K="dec",c(2)})),h.forEach((function(e){e.addEventListener("click",(function(){c(0)}))})),b.addEventListener("input",(()=>{8==b.value.length?b.classList.add("inputs__key-input--success"):b.classList.remove("inputs__key-input--success")})),w.addEventListener("click",(()=>{b.type="password"===b.type?"text":"password",_.classList.toggle("inputs__key-hidden--visible")})),x.addEventListener("click",(()=>{b.classList.add("inputs__key-input--success"),b.value=function(){let e="";for(let t=0;t<8;t++){let t=Math.floor(69*Math.random());e+=d[t]}return e}()})),T.addEventListener("click",(()=>{navigator.clipboard.readText().then((e=>b.value=e.slice(0,8))).catch((e=>console.error("Unable to paste from clipboard: "+e))),8==b.value.length?b.classList.add("inputs__key-input--success"):b.classList.remove("inputs__key-input--success")})),D.addEventListener("click",(()=>function(){let e=b.value;navigator.clipboard.writeText(e).then((()=>alert("Текст скопійовано в буфер обміну: "+e))).catch((e=>alert("Помилка копіювання: "+e)))}())),A.addEventListener("click",(()=>o("enc"))),C.addEventListener("click",(()=>o("dec"))),O.addEventListener("click",(function(){p.toBlob((function(e){const t=new ClipboardItem({"image/png":e});navigator.clipboard.write([t]).then((()=>alert("Image copied to clipboard!"))).catch((function(e){console.error("Error:",e)}))}),"image/png")}))})();