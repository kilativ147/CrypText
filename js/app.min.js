(()=>{"use strict";const e=document.getElementById("burger-button"),t=document.getElementById("header-menu"),n=e.className,s=t.className;e.addEventListener("click",(function(){e.classList.toggle(`${n}--active`),t.classList.toggle(`${s}--active`),document.body.classList.toggle("body--lock")}));const d=document.getElementById("drop-area"),a=document.getElementById("input-file"),i=document.getElementById("option-main"),l=document.getElementById("canvas"),c=l.getContext("2d"),o=document.getElementById("button-option__encrypt"),r=document.getElementById("button-option__decrypt"),u=document.querySelectorAll(".encryption__reset"),m=document.getElementById("inputs-main"),p=document.getElementById("inputs__text"),g=document.getElementById("text-tooltip"),v=document.getElementById("input-text"),y=(document.getElementById("inputs__key"),document.getElementById("input-key-text-span")),h=document.getElementById("key-tooltip"),L=document.getElementById("input-key"),E=document.getElementById("key-generate"),f=document.getElementById("key-copy"),I=document.getElementById("text-encrypt"),B=document.getElementById("text-decrypt"),b=document.getElementById("result-main"),k=document.getElementById("result-enc"),w=document.getElementById("result-key"),_=document.getElementById("canvas-download"),x=document.getElementById("canvas-clipboard"),D=document.getElementById("result-dec"),A=document.getElementById("decrypted-message"),C=5e4;let T=0,M="";const R="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-!@#$%&";let U=[];function N(e){0==e&&(a.value="",c.clearRect(0,0,l.width,l.height),v.value="",L.value="",U.length=0,i.classList.remove("option--visible"),m.classList.remove("inputs--visible"),b.classList.remove("result--visible"),p.classList.remove("inputs--decrypt"),y.classList.remove("inputs--decrypt"),E.classList.remove("inputs--decrypt"),f.classList.remove("inputs--decrypt"),I.classList.remove("inputs--decrypt"),B.classList.remove("inputs--encrypt"),k.classList.remove("result--decrypt"),D.classList.remove("result--encrypt")),1==e&&i.classList.add("option--visible"),2==e&&(m.classList.add("inputs--visible"),(M="enc")?B.classList.add("inputs--encrypt"):(p.classList.add("inputs--decrypt"),y.classList.add("inputs--decrypt"),E.classList.add("inputs--decrypt"),f.classList.add("inputs--decrypt"),I.classList.add("inputs--decrypt"))),3==e&&(b.classList.add("result--visible"),"enc"==M?(w.value=L.value,D.classList.add("result--encrypt")):(A.innerText="Some shit",k.classList.add("result--decrypt")))}function O(){const e=new Image;a.files[0]&&(e.src=URL.createObjectURL(a.files[0]),e.addEventListener("load",(()=>{l.width=e.width,l.height=e.height,e.width>=512&&e.height>=512?(N(1),setTimeout((function(){c.drawImage(e,0,0,l.width,l.height),T=function(e){let t=e.getImageData(0,0,l.width,l.height).data.length;return Math.floor(t/C)}(c),v.setAttribute("maxlength",T)}),1e3)):N(0)})))}d.addEventListener("dragover",(e=>{e.preventDefault(),d.classList.add("drag-over")})),d.addEventListener("dragleave",(e=>{e.preventDefault(),d.classList.remove("drag-over")})),d.addEventListener("drop",(e=>{e.preventDefault(),d.classList.remove("drag-over"),a.files=e.dataTransfer.files,O()})),a.onchange=O,o.addEventListener("click",(()=>{M="enc",N(2)})),r.addEventListener("click",(()=>{M="dec",N(2)})),u.forEach((function(e){e.addEventListener("click",(function(){N(0)}))})),v.addEventListener("input",(()=>{let e=v.value;e.charCodeAt(e.length-1)>140&&(v.value=e.slice(0,-1))})),L.addEventListener("input",(()=>{8==L.value.length?L.classList.add("inputs__key-input--success"):L.classList.remove("inputs__key-input--success")})),E.addEventListener("click",(()=>{L.classList.add("inputs__key-input--success"),L.value=function(){let e="";for(let t=0;t<8;t++){let t=Math.floor(69*Math.random());e+=R[t]}return e}()})),f.addEventListener("click",(()=>function(){let e=L.value;navigator.clipboard.writeText(e).then((()=>{alert("Текст скопійовано в буфер обміну: "+e)})).catch((e=>{console.error("Помилка копіювання: ",e)}))}())),I.addEventListener("click",(()=>function(e){const t="inputs-tooltip--animate",n=v.value,s=n.length>=5,d=L.value,i=8==d.length;let o=!0;for(let e=0;e<n.length;e++)if(-1===R.indexOf(n[e])){o=!1;break}let r=!0;for(let e=0;e<d.length;e++)if(-1===R.indexOf(d[e])){r=!1;break}s&&o||(g.classList.add(t),setTimeout((()=>{g.classList.remove(t)}),2e3)),i&&r||(h.classList.add(t),setTimeout((()=>{h.classList.remove(t)}),2e3)),s&&o&&i&&r&&function(){let e=function(e){let t=[];for(let n=0;n<e.length;n++)n%2==0?t.push(e.charCodeAt(n)):t.push("-"+e.charCodeAt(n));return t=Math.abs(t.map((e=>Math.floor(.5*Number(e)))).reduce(((e,t)=>e+t))),t>=100?t=100:t}(L.value);U.length=0;let t=v.value;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n)+e;U.push(s)}const n=c.getImageData(0,0,l.width,l.height).data;let s=0;for(let e=C;e<n.length;e+=C)s<U.length?(n[e+3]=255-U[s],s++):n[e+3]<125?n[e+3]=0:n[e+3]=255;const d=new ImageData(new Uint8ClampedArray(n),l.width,l.height);c.putImageData(d,0,0),N(3),_.href=l.toDataURL(),_.download=a.files[0].name}()}())),x.addEventListener("click",(function(){l.toBlob((function(e){const t=new ClipboardItem({"image/png":e});navigator.clipboard.write([t]).then((()=>alert("Image copied to clipboard!"))).catch((function(e){console.error("Error:",e)}))}),"image/png")}))})();