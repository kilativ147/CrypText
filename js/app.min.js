(()=>{"use strict";var e={d:(t,n)=>{for(var l in n)e.o(n,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:n[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{RT:()=>L,x5:()=>_,ZF:()=>C,nK:()=>B,fr:()=>x});const t=document.getElementById("toImg_input-file"),n=document.getElementById("toImg_canvas"),l=n.getContext("2d"),o=document.getElementById("toImg_canvas-reset"),a=document.getElementById("toImg_text-to-crypto-label"),d=document.getElementById("toImg_input-text"),i=document.getElementById("toImg_crypto-key-label"),c=document.getElementById("toImg_input-key"),r=document.getElementById("toImg_key-generate"),s=document.getElementById("toImg_text-encrypt"),g=document.getElementById("toImg_canvas-download"),h=document.getElementById("toImg_canvas-copy");let m=[];function u(e){e>=1?(o.style.display="block",a.style.display="block"):(t.value="",l.clearRect(0,0,n.width,n.height),d.value="",c.value="",m.length=0,o.style.display="none",a.style.display="none"),e>=2?i.style.display="block":(i.style.display="none",c.value=""),s.style.display=e>=3?"block":"none",4==e?(g.style.display="block",h.style.display="block"):(g.style.display="none",h.style.display="none")}function y(e){let t=e.slice(2),n=[];for(let e=0;e<t.length;e++)e%2==0?n.push(t.charCodeAt(e)):n.push("-"+t.charCodeAt(e));return n=Math.abs(n.map((e=>Math.floor(.5*Number(e)))).reduce(((e,t)=>e+t))),n>=x?n=x:n}const p=document.getElementById("toText_input-file"),I=document.getElementById("toText_canvas"),f=I.getContext("2d"),v=document.getElementById("toText_canvas-reset"),b=document.getElementById("toText_crypto-key-label"),E=document.getElementById("toText_input-key"),w=document.getElementById("toText_key-confirm"),k=document.getElementById("toText_message");function A(e){e>=1?(v.style.display="block",b.style.display="block",E.style.display="block"):(p.value="",f.clearRect(0,0,I.width,I.height),E.value="",v.style.display="none",b.style.display="none",E.style.display="none"),w.style.display=e>=2?"block":"none",k.style.display=e>=3?"block":"none"}!function(e){let t=new Image;t.onload=t.onerror=function(){!function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}();const B=512,C=512,L=8,_=100,x=100;t.onchange=function(){const e=new Image;e.src=URL.createObjectURL(t.files[0]),e.addEventListener("load",(()=>{n.width=e.width,n.height=e.height,e.width>=B&&e.height>=C?(u(1),l.drawImage(e,0,0,n.width,n.height)):u(0)}))},o.addEventListener("click",(()=>u(0))),d.addEventListener("input",(()=>{let e=d.value;e.charCodeAt(e.length-1)>150&&(d.value=e.slice(0,-1),console.log("Недопустимий символ!")),d.value.length>=5?c.value.length==L?u(3):u(2):u(1)})),c.addEventListener("input",(()=>{c.value.length==L?u(3):u(2)})),r.addEventListener("click",(()=>c.value=function(){let e="",t=!1,n=d.value.length+_;do{const l=48,o=123;let a=Math.floor(Math.random()*(o-l+1))+l,d=n-a;d>l&&d<o&&(t=!0,e+=String.fromCharCode(a)+String.fromCharCode(d))}while(!t);for(let t=0;t<L-2;t++)e+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-!@#$%&*"[Math.floor(71*Math.random())];return console.log(e),u(3),e}())),s.addEventListener("click",(function(){let e=y(c.value);m.length=0;let o=d.value;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t)+e;m.push(n)}const a=l.getImageData(0,0,n.width,n.height).data;let i=m.length,r=a.length,s=Math.floor(r/(i+5)),h=0;for(let e=s;e<a.length;e+=s)a[e+3]=m[h],h++;const p=new ImageData(new Uint8ClampedArray(a),n.width,n.height);l.putImageData(p,0,0),u(4),g.href=n.toDataURL(),g.download=t.files[0].name})),h.addEventListener("click",(function(){n.toBlob((function(e){const t=new ClipboardItem({"image/png":e});navigator.clipboard.write([t]).then((function(){alert("Image copied to clipboard!")})).catch((function(e){console.error("Error:",e)}))}),"image/png")})),p.onchange=function(){const e=new Image;e.src=URL.createObjectURL(p.files[0]),e.addEventListener("load",(()=>{I.width=e.width,I.height=e.height,e.width>=B&&e.height>=C?(E.value="",A(1),f.drawImage(e,0,0,I.width,I.height)):A(0)}))},v.addEventListener("click",(()=>A(0))),E.addEventListener("input",(()=>{E.value.length==L?A(2):A(1)})),w.addEventListener("click",(()=>{k.innerHTML="",k.textContent=function(){let e=E.value,t=e.slice(0,2),n=Number(t.charCodeAt(0))+Number(t.charCodeAt(1))-_,l=y(e);const o=f.getImageData(0,0,I.width,I.height).data;let a=n,d=o.length,i=Math.floor(d/(a+5)),c=[],r=0;for(let e=i;r<n;e+=i){let t=o[e+3]-l;c[r]=t>0&&t<150?t:63,r++}return c.map((e=>String.fromCharCode(e))).join("")}(),A(3)}))})();